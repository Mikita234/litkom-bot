#!/usr/bin/env python3
"""
Скрипт для загрузки литературы на сервере Render.com
Запускать через Render.com Console или как отдельный деплой
"""

import asyncio
import sys
import os

# Добавляем текущую директорию в путь
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

# Используем ту же логику выбора БД, что и в main.py
try:
    from db_postgres import db
    print("📊 Используется PostgreSQL")
except ImportError:
    from db import db
    print("📊 Fallback на SQLite")

# Полный список литературы с категориями, ценами и себестоимостью
LITERATURE_DATA = [
    # Книги (цены в злотых)
    ("Базовый текст «Анонимные Наркоманы»", "Книги", 26.0, 18.0, 5),
    ("Руководство к работе по шагам в АН", "Книги", 34.0, 24.0, 3),
    ("Спонсорство", "Книги", 35.0, 25.0, 3),
    ("Жить чистыми: путешествие продолжается", "Книги", 29.0, 20.0, 3),
    ("Это работает: как и почему?", "Книги", 17.0, 12.0, 3),
    ("Ежедневные размышления «Только Сегодня»", "Книги", 19.0, 13.0, 5),
    ("Только Сегодня (книга)", "Книги", 18.0, 12.0, 3),
    ("Базовый текст (вариант «У»)", "Книги", 26.0, 18.0, 2),
    ("Ежедневные размышления «Только Сегодня (вариант У)»", "Книги", 19.0, 13.0, 2),
    ("Двенадцать концепций служения АН", "Книги", 15.0, 10.0, 2),
    ("Ознакомительное руководство к АН", "Книги", 12.0, 8.0, 3),
    
    # Брелоки (цены в злотых)
    ("Брелок «30 дней»", "Брелоки", 5.0, 3.0, 10),
    ("Брелок «60 дней»", "Брелоки", 5.0, 3.0, 10),
    ("Брелок «90 дней»", "Брелоки", 5.0, 3.0, 10),
    ("Брелок «6 месяцев»", "Брелоки", 5.0, 3.0, 10),
    ("Брелок «9 месяцев»", "Брелоки", 5.0, 3.0, 5),
    ("Брелок «1 год»", "Брелоки", 7.0, 4.0, 10),
    ("Брелок «1.5 года (18 месяцев)»", "Брелоки", 7.0, 4.0, 5),
    ("Брелок «Несколько лет»", "Брелоки", 7.0, 4.0, 5),
    ("Брелок «2 года»", "Брелоки", 7.0, 4.0, 5),
    ("Брелок «3 года»", "Брелоки", 7.0, 4.0, 5),
    ("Брелок «4 года»", "Брелоки", 7.0, 4.0, 3),
    ("Брелок «10 лет»", "Брелоки", 10.0, 6.0, 3),
    
    # Медали (цены в злотых)
    ("Медаль «1 год»", "Медали", 15.0, 9.0, 5),
    ("Медаль «3 года»", "Медали", 15.0, 9.0, 3),
    
    # Буклеты и информационные материалы (цены в злотых)
    ("Белый буклет", "Буклеты", 3.0, 2.0, 20),
    ("Руководство доверенных служителей группы", "Буклеты", 5.0, 3.0, 5),
    ("Буклет «Онлайн»", "Буклеты", 4.0, 2.5, 5),
    ("Буклет «Двенадцать концепций служения АН»", "Буклеты", 4.0, 2.5, 5),
    ("Буклет «Заболевания и выздоровление»", "Буклеты", 4.0, 2.5, 5),
    
    # IP (Information Pamphlet) - Информационные памфлеты (цены в злотых)
    ("IP №1 «Кто, что, как и почему?»", "IP", 1.5, 1.0, 15),
    ("IP №16 «Новичку»", "IP", 1.5, 1.0, 30),
    ("IP №22 «Добро пожаловать в Сообщество АН»", "IP", 1.5, 1.0, 20),
    ("IP №2 «Группа»", "IP", 1.5, 1.0, 10),
    ("IP №5 «Другой взгляд»", "IP", 1.5, 1.0, 10),
    ("IP №6 «Выздоровление и срыв»", "IP", 1.5, 1.0, 15),
    ("IP №7 «Зависимый ли я?»", "IP", 1.5, 1.0, 20),
    ("IP №8 «Только сегодня»", "IP", 1.5, 1.0, 15),
    ("IP №9 «Жить программой»", "IP", 1.5, 1.0, 10),
    ("IP №10 «Работа над Шагом Четвёртым в АН»", "IP", 1.5, 1.0, 10),
    ("IP №11 «Спонсорство»", "IP", 1.5, 1.0, 15),
    ("IP №12 «Треугольник одержимости своими желаниями»", "IP", 1.5, 1.0, 10),
    ("IP №13 «Юным зависимым от юных зависимых»", "IP", 1.5, 1.0, 10),
    ("IP №14 «Опыт одного зависимого…»", "IP", 1.5, 1.0, 10),
    ("IP №15 «Служение СО и членство в АН»", "IP", 1.5, 1.0, 10),
    ("IP №17 «Если ты на реабилитации»", "IP", 1.5, 1.0, 10),
    ("IP №19 «Принятие себя»", "IP", 1.5, 1.0, 10),
    ("IP №20 «Служение БУ и членство в АН»", "IP", 1.5, 1.0, 10),
    ("IP №21 «Одиночка – оставаться чистым в изоляции»", "IP", 1.5, 1.0, 10),
    ("IP №23 «Оставаться чистым после выписки»", "IP", 1.5, 1.0, 10),
    ("IP №24 «Про деньги. Самообеспечение имеет значение»", "IP", 1.5, 1.0, 10),
    ("IP №26 «Доступность собраний для зависимых с ограниченными возможностями»", "IP", 1.5, 1.0, 5),
    ("IP №27 «Для родителей или опекунов несовершеннолетних в АН»", "IP", 1.5, 1.0, 5),
    ("IP №28 «Финансирование органов обслуживания АН»", "IP", 1.5, 1.0, 10),
    ("IP №29 «Собрания сообщества АН: Что это такое?»", "IP", 1.5, 1.0, 10),
    ("IP «Информация о АН»", "IP", 1.5, 1.0, 15),
    ("IP «АН ресурс»", "IP", 1.5, 1.0, 10),
    ("IP «Лица, лечение, терапия»", "IP", 1.5, 1.0, 10),
    
    # СП (Service Pamphlet) - Сервисные памфлеты (цены в злотых)
    ("СП «Собрания АН»", "СП", 2.0, 1.2, 10),
    ("СП «Шумное и буйное поведение на собраниях»", "СП", 2.0, 1.2, 5),
    ("СП «Доверенные служители группы. Роли и обязанности»", "СП", 2.0, 1.2, 10),
    ("СП «Социальные сети и наши путеводные принципы»", "СП", 2.0, 1.2, 10),
    ("СП «Принципы и лидерство»", "СП", 2.0, 1.2, 10),
    ("СП «Работа собраний»", "СП", 2.0, 1.2, 10),
    ("СП «АН и препараты в выздоровлении»", "СП", 2.0, 1.2, 10),
]

async def load_literature():
    """Загрузка литературы в базу данных"""
    print("🚀 Начинаем загрузку литературы...")
    
    # Инициализируем базу данных
    await db.init_database()
    print("✅ База данных инициализирована")
    
    # Загружаем литературу
    loaded_count = 0
    for name, category, price, cost, min_stock in LITERATURE_DATA:
        success = await db.add_item(name, category, price, cost, min_stock)
        if success:
            loaded_count += 1
            print(f"✅ Добавлено: {name} - {price} zł")
        else:
            print(f"❌ Ошибка: {name}")
    
    print(f"\n🎉 Загружено {loaded_count} позиций литературы!")
    print("📱 Теперь можно использовать бота для управления литературой")

if __name__ == "__main__":
    asyncio.run(load_literature())
